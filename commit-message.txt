Update frontend authentication to handle token and redirection